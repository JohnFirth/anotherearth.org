/* Copyright 2010, John Firth. Licensed under BSD (see http://www.anotherearth.org/license.txt)
 * Incorporates:
 * Translator.js Copyright 2008 Ariel Fleischer.
 * jQuery.js Copyright 2010 John Resig.
 * jQuery-ui.js Copyright 2010 Copyright 2009 various authors (http://jqueryui.com/about) 
 * ui-dropdown-checklist.js Copyright 2008-2009 Adrian Tosca
 *
 * unminified files in js/
 */
function Translator(b,a){this.parse=b;this.filter=a}Translator.prototype={translate:function(a){if(this.sync){this.replace(a,this.parse(a.nodeValue))}else{var b=this;this.parse(a.nodeValue,function(c){b.replace(a,c)})}},makeNode:function(a){if(a&&a.split){a=document.createTextNode(a)}return a},replace:function(b,e){if(e!=null&&e!=b.nodeValue){var d=b.parentNode;if(e.splice){for(var c=0,a=e.length-1;c<a;){d.insertBefore(this.makeNode(e[c++]),b)}e=this.makeNode(e[a]||"")}else{e=this.makeNode(e)}d.replaceChild(e,b)}},valid:/\S/,sync:true,traverse:function(b){var c=b.childNodes,a=c.length,d;while(a--){d=c[a];if(d.nodeType==3){if(this.valid.test(d.nodeValue)){this.translate(d)}}else{if(d.nodeType==1&&(!this.filter||this.filter(d))){this.traverse(d)}}}}};(function(a){a.widget("ui.dropdownchecklist",{_appendDropContainer:function(){var c=a("<div/>");c.addClass("ui-dropdownchecklist-dropcontainer-wrapper");c.css({position:"absolute",left:"-3300",top:"-3300px",width:"3000px",height:"3000px"});var b=a("<div/>");b.addClass("ui-dropdownchecklist-dropcontainer").css("overflow-y","auto");c.append(b);a(document.body).append(c);c.drop=false;return c},_isDropDownKeyShortcut:function(b){return b.altKey&&(a.ui.keyCode.DOWN==(b.keyCode||b.which))},_isDroDownCloseKey:function(b){return a.ui.keyCode.ESCAPE==(b.keyCode||b.which)},_handleKeyboard:function(c){var b=this;if(b._isDropDownKeyShortcut(c)){c.stopPropagation();b._toggleDropContainer();b.dropWrapper.find("input:first").focus()}else{if(b.dropWrapper.drop&&b._isDroDownCloseKey(c)){b._toggleDropContainer()}}},_appendControl:function(){var b=this,c=this.sourceSelect;var f=a("<span/>");f.addClass("ui-dropdownchecklist-wrapper");f.css({display:"inline-block",cursor:"default"});var e=a("<span/>");e.addClass("ui-dropdownchecklist");e.css({display:"inline-block"});e.attr("tabIndex",0);e.keyup(function(g){b._handleKeyboard(g)});f.append(e);var d=a("<span/>");d.addClass("ui-dropdownchecklist-text");d.css({display:"inline-block",overflow:"hidden"});e.append(d);f.hover(function(){if(!b.disabled){e.toggleClass("ui-dropdownchecklist-hover")}},function(){if(!b.disabled){e.toggleClass("ui-dropdownchecklist-hover")}});f.click(function(g){if(!b.disabled){g.stopPropagation();b._toggleDropContainer()}});f.insertAfter(c);return f},_createDropItem:function(h,k,m,l,f,d){var o=this;var n=a("<div/>");n.addClass("ui-dropdownchecklist-item");n.css({whiteSpace:"nowrap"});var c=l?' checked="checked"':"";var j=f?' disabled="disabled"':"";var p=(o.sourceSelect.attr("id")||"ddcl");var b=p+h;var g;if(o.initialMultiple){g=a('<input type="checkbox" id="'+b+'"'+c+j+"/>")}else{g=a('<input type="radio" id="'+b+'" name="'+p+'"'+c+j+"/>")}g=g.attr("index",h).val(k);n.append(g);var i=a("<label for="+b+"/>");i.addClass("ui-dropdownchecklist-text").css({cursor:"default",width:"100%"}).text(m);if(d){n.addClass("ui-dropdownchecklist-indent")}if(f){n.addClass("ui-dropdownchecklist-item-disabled")}n.append(i);g.click(function(q){q.stopPropagation();if(!f){o._syncSelected(a(this));o.sourceSelect.trigger("change","ddcl_internal")}});var e=function(q){q.stopPropagation()};i.click(function(q){q.stopPropagation()});n.click(e);n.keyup(function(q){o._handleKeyboard(q)});return n},_createGroupItem:function(d){var c=a("<div />");c.addClass("ui-dropdownchecklist-group");c.css({whiteSpace:"nowrap"});var b=a("<span/>");b.addClass("ui-dropdownchecklist-text").css({cursor:"default",width:"100%"}).text(d);c.append(b);return c},_appendItems:function(){var d=this,g=this.sourceSelect,f=this.dropWrapper;var b=f.find(".ui-dropdownchecklist-dropcontainer");b.css({"float":"left"});g.children().each(function(h){var i=a(this);if(i.is("option")){d._appendOption(i,b,h,false)}else{var k=i.attr("label");var j=d._createGroupItem(k);b.append(j);d._appendOptions(i,b,h,true)}});var c=b.outerWidth();var e=b.outerHeight();b.css({"float":""});return{width:c,height:e}},_appendOptions:function(f,c,e,b){var d=this;f.children("option").each(function(g){var h=a(this);var i=(e+"."+g);d._appendOption(h,c,i,b)})},_appendOption:function(f,b,g,c){var k=this;var i=f.text();var h=f.val();var e=f.attr("selected");var d=f.attr("disabled");var j=k._createDropItem(g,h,i,e,d,c);b.append(j)},_syncSelected:function(g){var h=this,i=this.options,c=this.sourceSelect,d=this.dropWrapper;var f=d.find("input:not([disabled])");if(i.firstItemChecksAll){if(g.attr("index")==0){f.attr("checked",g.attr("checked"))}else{var e;e=true;f.each(function(k){if(k>0){var l=a(this).attr("checked");if(!l){e=false}}});var j=f.filter(":first");j.attr("checked",false);if(e){j.attr("checked",true)}}}var b=c.get(0).options;f.each(function(k){a(b[k]).attr("selected",a(this).attr("checked"))});h._updateControlText()},_sourceSelectChangeHandler:function(c){var b=this,d=this.dropWrapper;d.find("input").val(b.sourceSelect.val());b._updateControlText()},_updateControlText:function(){var h=this,b=this.sourceSelect,i=this.options,e=this.controlWrapper;var j=b.find("option:first");var f=null!=j&&j.attr("selected");var c=b.find("option");var g=h._formatText(c,i.firstItemChecksAll,f);var d=e.find(".ui-dropdownchecklist-text");d.text(g);d.attr("title",g)},_formatText:function(c,d,b){var e;if(d&&b){e=c.filter(":first").text()}else{e="";c.each(function(){if(a(this).attr("selected")){e+=a(this).text()+", "}});if(e.length>0){e=e.substring(0,e.length-2)}}return e},_toggleDropContainer:function(){var c=this,f=this.dropWrapper,e=this.controlWrapper;var d=function(){var g=a.ui.dropdownchecklist.drop;if(null!=g){g.dropWrapper.css({top:"-3300px",left:"-3300px"});g.controlWrapper.find(".ui-dropdownchecklist").toggleClass("ui-dropdownchecklist-active");g.dropWrapper.find("input").attr("tabIndex",-1);g.dropWrapper.drop=false;a.ui.dropdownchecklist.drop=null;a(document).unbind("click",d);c.sourceSelect.trigger("blur")}};var b=function(g){if(null!=a.ui.dropdownchecklist.drop){d()}g.dropWrapper.css({top:(g.controlWrapper.offset().top+g.controlWrapper.outerHeight()-1)+"px",left:g.controlWrapper.offset().left+"px"});var i=e.parents().map(function(){var j=a(this).css("z-index");return isNaN(j)?0:j}).get();var h=Math.max.apply(Math,i);if(h>0){g.dropWrapper.css({zIndex:(h+1)})}g.controlWrapper.find(".ui-dropdownchecklist").toggleClass("ui-dropdownchecklist-active");g.dropWrapper.find("input").attr("tabIndex",0);g.dropWrapper.drop=true;a.ui.dropdownchecklist.drop=g;a(document).bind("click",d);c.sourceSelect.trigger("focus")};if(f.drop){d(c)}else{b(c)}},_setSize:function(b){var j=this.options,e=this.dropWrapper,h=this.controlWrapper;var g;if(j.width){g=parseInt(j.width)}else{g=b.width;var c=j.minWidth;if(g<c){g=c}}h.find(".ui-dropdownchecklist-text").css({width:g+"px"});var i=h.outerWidth();var f=j.maxDropHeight?parseInt(j.maxDropHeight):b.height;var d=b.width<i?i:b.width;a(e).css({width:(d+2)+"px",height:f+"px"});e.find(".ui-dropdownchecklist-dropcontainer").css({height:f+"px"})},_init:function(){var c=this,d=this.options;var g=c.element;c.initialDisplay=g.css("display");g.css("display","none");c.initialMultiple=g.attr("multiple");g.attr("multiple","multiple");c.sourceSelect=g;var f=c._appendDropContainer();c.dropWrapper=f;var b=c._appendItems();var e=c._appendControl();c.controlWrapper=e;c._updateControlText(e,f,g);c._setSize(b);if(d.bgiframe&&typeof c.dropWrapper.bgiframe=="function"){c.dropWrapper.bgiframe()}c.sourceSelect.change(function(i,h){if(h!="ddcl_internal"){c._sourceSelectChangeHandler(i)}})},hide:function(){var c=this,e=this.dropWrapper,d=this.controlWrapper;var b=a.ui.dropdownchecklist.drop;if(null!=b){b.dropWrapper.css({top:"-3300px",left:"-3300px"});b.controlWrapper.find(".ui-dropdownchecklist").toggleClass("ui-dropdownchecklist-active");b.dropWrapper.find("input").attr("tabIndex",-1);b.dropWrapper.drop=false;a.ui.dropdownchecklist.drop=null;c.sourceSelect.trigger("blur")}},enable:function(){this.controlWrapper.find(".ui-dropdownchecklist").removeClass("ui-dropdownchecklist-disabled");this.controlWrapper.find(".ui-dropdownchecklist-item > input[type=checkbox]").removeAttr("disabled");this.disabled=false},disable:function(){this.controlWrapper.find(".ui-dropdownchecklist").addClass("ui-dropdownchecklist-disabled");this.controlWrapper.find(".ui-dropdownchecklist-item > input[type=checkbox]").attr("disabled","disabled");this.disabled=true},destroy:function(){a.widget.prototype.destroy.apply(this,arguments);this.sourceSelect.css("display",this.initialDisplay);this.sourceSelect.attr("multiple",this.initialMultiple);this.controlWrapper.unbind().remove();this.dropWrapper.remove()}});a.extend(a.ui.dropdownchecklist,{defaults:{width:null,maxDropHeight:null,firstItemChecksAll:false,minWidth:50,bgiframe:false}})})(jQuery);(function(d){d.fn.bgiframe=(d.browser.msie&&/msie 6\.0/i.test(navigator.userAgent)?function(a){a=d.extend({top:"auto",left:"auto",width:"auto",height:"auto",opacity:true,src:"javascript:false;"},a);var b='<iframe class="bgiframe"frameborder="0"tabindex="-1"src="'+a.src+'"style="display:block;position:absolute;z-index:-1;'+(a.opacity!==false?"filter:Alpha(Opacity='0');":"")+"top:"+(a.top=="auto"?"expression(((parseInt(this.parentNode.currentStyle.borderTopWidth)||0)*-1)+'px')":c(a.top))+";left:"+(a.left=="auto"?"expression(((parseInt(this.parentNode.currentStyle.borderLeftWidth)||0)*-1)+'px')":c(a.left))+";width:"+(a.width=="auto"?"expression(this.parentNode.offsetWidth+'px')":c(a.width))+";height:"+(a.height=="auto"?"expression(this.parentNode.offsetHeight+'px')":c(a.height))+';"/>';return this.each(function(){if(d(this).children("iframe.bgiframe").length===0){this.insertBefore(document.createElement(b),this.firstChild)}})}:function(){return this});d.fn.bgIframe=d.fn.bgiframe;function c(a){return a&&a.constructor===Number?a+"px":a}})(jQuery);google.load("maps","2");google.load("earth","1");google.load("language","1");google.load("search","1");var org=window.org||{};if(typeof org.anotherearth!=="undefined"){throw new Error("org.anotherearth already exists.")}org.anotherearth={JAVASCRIPT_DISABLED_MESSAGE_ID:"js_disabled_message",L_EARTH_ID:"left_earth",R_EARTH_ID:"right_earth",L_EARTH_SEARCH_BOX_ID:"l_earth_search",R_EARTH_SEARCH_BOX_ID:"r_earth_search",CP_ID:"control_panel",CP_HEADER_ID:"control_panel_header",CP_BUTTONS_CONTAINER_ID:"control_panel_widgets",CP_UNDO_BUTTON_ID:"undo",CP_REDO_BUTTON_ID:"redo",CP_L_EARTH_EXTRAS_SELECTOR_ID:"left_earth_extras_selector",CP_R_EARTH_EXTRAS_SELECTOR_ID:"right_earth_extras_selector",CP_LINK_CREATOR_BUTTON_ID:"link_creator",CP_LINK_BOX_ID:"link_box",CP_LINK_CREATOR_CONTAINER_ID:"link_creator_container",CP_ALTITUDE_LOCK_CHECKBOX_ID:"altitude_lock",CP_VIEW_CENTER_LOCK_CHECKBOX_ID:"view_center_lock",CP_TILT_LOCK_CHECKBOX_ID:"tilt_lock",CP_HEAD_LOCK_CHECKBOX_ID:"heading_lock",CP_EARTH_OPTIONS_SUB_PANEL_ID:"earth_options",CP_MISC_OPTIONS_SUB_PANEL_ID:"misc_options",CP_SEARCH_BOX_SUB_PANEL_ID:"search_boxes",WELCOME_PANEL_ID:"welcome_panel",WELCOME_PANEL_HEADER_ID:"welcome_panel_header",WELCOME_PANEL_BODY_ID:"welcome_panel_body",CP_CAMERA_PROPERTY_LOCKING_SUB_PANEL_ID:"camera_propety_locking_checkboxes",CP_CAMERA_PROPERTY_COPYING_SUB_PANEL_ID:"camera_property_copying_buttons",EQUATE_CAM_ALTITUDES_BUTTON_ID:"equate_camera_altitudes",EQUATE_CAM_LATS_LNGS_BUTTON_ID:"equate_camera_latitudes_and_longitudes",EQUATE_CAM_TILTS_BUTTON_ID:"equate_camera_tilts",EARTH_CANVAS_CLASS:"earth_canvas",CP_OPEN_ICON_CLASS:"ui-icon-arrowthickstop-1-n",CP_SHUT_ICON_CLASS:"ui-icon-arrowthickstop-1-s",CP_CAPTION_BUTTON_CLASS:"control_panel_caption_button",SUB_PANEL_CAPTION_BUTTON_CLASS:"sub_panel_caption_button",SUB_PANEL_SHUT_ICON_CLASS:"ui-icon-circle-triangle-e",SUB_PANEL_OPEN_ICON_CLASS:"ui-icon-circle-triangle-s",PANEL_TITLE_CLASS:"panel_title",SEARCH_BOX_CLASS:"search_box",PLUGIN_INCOMPATIBILITY_MESSAGE_ID:"plugin_incompatibility_message",JS_INCOMPATIBILITY_MESSAGE_ID:"js_incompatibility_message",PLAIN_HTML_MESSAGE_ID:"html_welcome_message",DEFAULT_L_EARTH_COORDS:{LAT:33.43,LNG:61.24,ALT:10400000,TILT:0,HEAD:0},DEFAULT_R_EARTH_COORDS:{LAT:9.61,LNG:-78.33,ALT:10400000,TILT:0,HEAD:0}};org.anotherearth.ArrayList=function(){var a=[];var b=arguments;if(b.length>0){this.buffer=b[0]}var c=function(e){var g=e;var d=e.length;var f=0;this.hasNext=function(){return(f<d)};this.next=function(){if(this.hasNext()){return g[f++]}else{return null}}};this.add=function(d){a.push(d)};this.getLength=function(){return a.length};this.indexOf=function(d){for(var e=0;e<=a.length;e++){if(a[e]===d){break}}return e};this.iterator=function(){return new c(a)};this.remove=function(d){a.splice(d,1)}};org.anotherearth.NullIterator=function(){};org.anotherearth.NullIterator.prototype={next:function(){return null},hasNext:function(){return false}};org.anotherearth.IFrameGenerator={};org.anotherearth.IFrameGenerator.createFrame=function(){var a=document.createElement("iframe");a.setAttribute("allowtransparency","false");a.scrolling="no";a.frameBorder="0";a.src=(navigator.userAgent.indexOf("MSIE 6")>=0)?"":"javascript:void(0);";a.style.position="absolute";a.style.opacity=0;a.style.top=0;a.style.left=0;a.style.width="100%";a.style.height="100%";a.style.zIndex=-1;return a};org.anotherearth.ControlPanel=function(f,d,c,g,h,b,i,e){var a;this.addChild=function(j){a.addChild(j)};this.closeSubPanels=function(){a.closeSubPanels()};this.createGUIElements=function(k,m,n,l,j){a.createGUIElements(k,m,n,l,j)};this.getContainingElement=function(){return a.getContainingElement()};this.performNewEarthPropsUpdate=function(){this.createIterator();var j=a.getIterator();while(j.hasNext()){j.next().performNewEarthPropsUpdate()}};this.performUndoRedoUpdate=function(){this.createIterator();var j=a.getIterator();while(j.hasNext()){j.next().performUndoRedoUpdate()}};this.removeChild=function(j){a.removeChild(j)};this.show=function(){a.show()};this.hide=function(){a.hide()};this.setTabIndex=function(j){a.setTabIndex(j)};this.createIterator=function(){a.createIterator()};a=new org.anotherearth.Panel(f,d,c,g,h,b,i,e)};org.anotherearth.Panel=function(l,g,s,h,e,a,k,c){var j,m,p,i;var n=new org.anotherearth.ArrayList();var l=l;var g=g;var s=s;var h=h;var e=e;var a=a;var k=k;var c=c;var d=1;var o=this;var r=function(){var u=document.createElement("div");$(u).addClass(org.anotherearth.CP_CAPTION_BUTTON_CLASS).addClass("drag_handle").addClass("ui-state-default");var t=document.createElement("span");$(t).addClass("ui-icon").addClass("ui-icon-arrow-4-diag");u.appendChild(t);$(u).bind("mouseleave mouseenter",function(){$(this).toggleClass("ui-state-hover")});$(u).bind("focus blur",function(){$(this).toggleClass("ui-state-focus")});$(m).draggable({containment:"window",handle:u,start:function(){o.createIterator();while(p.hasNext()){var v=p.next();if(v instanceof org.anotherearth.SelectBox){v.hideDropDownList()}}$(u).addClass("ui-state-active")},stop:function(){$(u).removeClass("ui-state-active")}});return u};var f=function(){var u=document.createElement("div");$(u).addClass("ui-state-default").addClass(org.anotherearth.CP_CAPTION_BUTTON_CLASS);var t=document.createElement("span");u.appendChild(t);$(t).addClass("ui-icon").addClass(org.anotherearth.CP_OPEN_ICON_CLASS);$(u).click(function(){o.createIterator();if($(t).hasClass(org.anotherearth.CP_SHUT_ICON_CLASS)){while(p.hasNext()){p.next().show()}}if(!$.support.leadingWhitespace){$(j).show()}else{$(j).slideToggle(175)}if($(t).hasClass(org.anotherearth.CP_OPEN_ICON_CLASS)){while(p.hasNext()){p.next().hide()}}$(t).toggleClass(org.anotherearth.CP_SHUT_ICON_CLASS).toggleClass(org.anotherearth.CP_OPEN_ICON_CLASS);return false}).bind("mouseleave",function(){$(this).removeClass("ui-state-active")}).bind("mouseleave mouseenter",function(){$(this).toggleClass("ui-state-hover")}).bind("mousedown mouseup",function(){$(this).toggleClass("ui-state-active")}).bind("focus blur",function(){$(this).toggleClass("ui-state-focus")});return u};var q=function(){var u=document.createElement("div");$(u).addClass("ui-state-default").addClass(org.anotherearth.CP_CAPTION_BUTTON_CLASS);var t=document.createElement("span");u.appendChild(t);$(t).addClass("ui-icon").addClass("ui-icon-close");$(u).click(function(){$(m).remove();return false}).bind("mouseleave",function(){$(this).removeClass("ui-state-active")}).bind("mouseleave mouseenter",function(){$(this).toggleClass("ui-state-hover")}).bind("mousedown mouseup",function(){$(this).toggleClass("ui-state-active")}).bind("focus blur",function(){$(this).toggleClass("ui-state-focus")});return u};var b=function(u){var t=[];t.push(u);this.next=function(){if(this.hasNext()){var w=t[t.length-1];var v=w.next();if(v instanceof org.anotherearth.ShrinkableSubPanel){t.push(v.createIterator())}return v}else{return null}};this.hasNext=function(){if(t.length===0){return false}else{var v=t[t.length-1];if(!v.hasNext()){t.pop();return this.hasNext()}else{return true}}}};this.addChild=function(t){n.add(t);j.appendChild(t.getContainingElement())};this.closeSubPanels=function(){this.createIterator();while(p.hasNext()){var t=p.next();if(t instanceof org.anotherearth.ShrinkableSubPanel){t.close()}}};this.createGUIElements=function(t,x,y,v,u){m=document.createElement("form");m.id=y;m.setAttribute("z-index","10");$(m).addClass("panel").addClass("ui-widget").addClass("ui-widget-content");var w=document.createElement("div");w.id=x;$(w).addClass("panel_header");var z=document.createElement("h4");z.appendChild(document.createTextNode(v));$(z).addClass(org.anotherearth.PANEL_TITLE_CLASS);j=document.createElement("div");j.id=t;if(c){w.appendChild(q())}if(k){w.appendChild(f())}if(a){w.appendChild(r())}w.appendChild(z);m.appendChild(w);m.appendChild(j);m.style.display="none";i=org.anotherearth.IFrameGenerator.createFrame();m.insertBefore(i,m.firstChild);$(m).bgiframe();u.appendChild(m)};this.getContainingElement=function(){return m};this.getIterator=function(){if(typeof p!==undefined){return p}};this.performNewEarthPropsUpdate=function(){this.createIterator();while(p.hasNext()){p.next().performNewEarthPropsUpdate()}};this.performUndoRedoUpdate=function(){this.createIterator();while(p.hasNext()){p.next().performUndoRedoUpdate()}};this.removeChild=function(t){n.remove(n.getIndexOf(t));this.setTabIndex(2)};this.show=function(){this.createIterator();while(p.hasNext()){p.next().show()}m.style.display="block"};this.hide=function(){this.createIterator();while(p.hasNext()){p.next().hide()}m.style.display="none"};this.setTabIndex=function(u){var t=u;this.createIterator();while(p.hasNext()){t=p.next().setTabIndex(t)}};this.createIterator=function(){p=new b(n.iterator())};this.createGUIElements(l,g,s,h,e)};org.anotherearth.ShrinkableSubPanel=function(f,c){var h,a,g,e;var f=f;var c=c;var d=new org.anotherearth.ArrayList();var i=this;var b=false;this.close=function(){if(b){return}var l=function(){b=false};b=true;var k=i.createIterator();if($(g).css("display")==="none"){while(k.hasNext()){k.next().show()}$(g).slideToggle(175,l)}else{if($(g).css("display")!=="none"){var j=function(){while(k.hasNext()){k.next().hide()}l()};$(g).slideToggle(175,j)}}$(e).toggleClass(org.anotherearth.SUB_PANEL_SHUT_ICON_CLASS).toggleClass(org.anotherearth.SUB_PANEL_OPEN_ICON_CLASS);return false};this.createGUIElements=function(){e=document.createElement("span");$(e).addClass(org.anotherearth.SUB_PANEL_CAPTION_BUTTON_CLASS).addClass("ui-icon").addClass(org.anotherearth.SUB_PANEL_OPEN_ICON_CLASS);h=document.createElement("div");h.id=c;$(h).addClass("sub_panel");a=document.createElement("h5");$(a).addClass("sub_panel_header");$(a).click(this.close);$(a).bind("mouseleave mouseenter",function(){$(this).toggleClass("sub_panel_header_highlight")});g=document.createElement("div");$(g).addClass("sub_panel_body");var j=document.createElement("span");j.appendChild(document.createTextNode(f));$(j).addClass("sub_panel_title");a.appendChild(e);a.appendChild(j);h.appendChild(a);h.appendChild(g);h.style.display="none"};this.addChild=function(j){d.add(j);g.appendChild(j.getContainingElement())};this.createIterator=function(){return d.iterator()};this.removeChild=function(j){d.remove(d.getIndexOf(j))};this.setTabIndex=function(j){return j};this.show=function(){var j=function(){e.style.visibility="visible"};h.style.display="block";e.style.visibility="hidden";setTimeout(j,70)};this.hide=function(){h.style.display="none"};this.getContainingElement=function(){return h};this.createGUIElements()};org.anotherearth.ShrinkableSubPanel.prototype={performNewEarthPropsUpdate:function(){},performUndoRedoUpdate:function(){}};org.anotherearth.MiscellaneousElement=function(b){var a=b;this.createGUIElements=function(c){a=c};this.createIterator=function(){return new org.anotherearth.NullIterator()};this.getContainingElement=function(){return a};this.setTabIndex=function(c){return c};this.show=function(){a.style.display="block"};this.hide=function(){a.style.display="none"};this.createGUIElements(b)};org.anotherearth.MiscellaneousElement.prototype={addChild:function(){},removeChild:function(){}};org.anotherearth.SimpleButton=function(f,e,b){var a,c,d;var e=e;var f=f;var b=b;this.createGUIElements=function(){a=document.createElement("div");$(a).addClass("control_panel_element");a.id=e+"_button_container";c=document.createElement("button");c.id=e;$(c).addClass("ui-state-default");$(c).attr("innerHTML",f);$(c).mouseenter(function(){$(this).toggleClass("ui-state-hover")});$(c).mouseleave(function(){$(this).toggleClass("ui-state-hover");$(this).removeClass("ui-state-active")});$(c).bind("mousedown mouseup",function(){$(this).toggleClass("ui-state-active")});$(c).bind("focus blur",function(){$(this).toggleClass("ui-state-focus")});a.appendChild(c);a.style.display="none"};this.addClickEventListener=function(g){$(c).bind("click",function(){g.execute();return false})};this.createIterator=function(){return new org.anotherearth.NullIterator()};this.getContainingElement=function(){return a};this.getModel=function(){return b};this.setIsEnabled=function(g){var h=d;if(h==g){return}if(g){$(c).removeAttr("disabled").removeClass("ui-state-disabled")}else{$(c).attr("disabled","disabled").removeClass("ui-state-hover").removeClass("ui-state-focus").addClass("ui-state-disabled")}};this.setTabIndex=function(g){c.setAttribute("tabindex",g++);return g};this.show=function(){a.style.display="block"};this.hide=function(){a.style.display="none"};this.createGUIElements()};org.anotherearth.SimpleButton.prototype={addChild:function(){},removeChild:function(){}};org.anotherearth.TwoEarthsButton=function(e,c,f){var b,d,a;this.addClickEventListener=function(g){b.addClickEventListener(g)};this.createGUIElements=function(){b.createGUIElements()};this.createIterator=function(){return b.createIterator()};this.getContainingElement=function(){return b.getContainingElement()};this.getModel=function(){return b.getModel()};this.performUndoRedoUpdate=function(){d.execute(this)};this.performNewEarthPropsUpdate=function(){a.execute(this)};this.setIsEnabled=function(g){b.setIsEnabled(g)};this.setUndoRedoUpdateStrategy=function(g){d=g};this.setNewEarthPropsUpdateStrategy=function(g){a=g};this.show=function(){b.show()};this.hide=function(){b.hide()};this.setTabIndex=function(g){return b.setTabIndex(g)};b=new org.anotherearth.SimpleButton(e,c,f);b.createGUIElements();d=new org.anotherearth.NullUpdateStrategy();a=new org.anotherearth.NullUpdateStrategy()};org.anotherearth.TwoEarthsButton.prototype={addChild:function(){},removeChild:function(){}};org.anotherearth.LinkCreatorButton=function(d,f,a,g){var e,i,h,c;var d=d;var f=f;var g=g;var a=a;var b=function(){i=document.createElement("input");i.setAttribute("type","text");i.id=a;e.getContainingElement().appendChild(i);i.style.display="none"};this.addLink=function(j){if(typeof i==="undefined"){b()}i.setAttribute("value",j);i.style.display="none"};this.addClickEventListener=function(j){e.addClickEventListener(j)};this.createGUIElements=function(){e.createGUIElements()};this.createIterator=function(){return e.createIterator()};this.getContainingElement=function(){return e.getContainingElement()};this.setIsEnabled=function(j){e.setIsEnabled(j)};this.setIsLinkVisible=function(k){if(typeof i==="undefined"){return}var j=(i.style.display==="block");if(j==k){return}else{if(k){i.style.display="block"}else{i.style.display="none"}}};this.show=function(){e.getContainingElement().style.display="block";if(typeof i!=="undefined"){i.style.display="none"}};this.hide=function(){e.getContainingElement().style.display="none"};this.setTabIndex=function(j){return e.setTabIndex(j)};this.performUndoRedoUpdate=function(){h.execute(this)};this.performNewEarthPropsUpdate=function(){c.execute(this)};this.setUndoRedoUpdateStrategy=function(j){h=j};this.setNewEarthPropsUpdateStrategy=function(j){c=j};e=new org.anotherearth.TwoEarthsButton(d,f,g);this.createGUIElements();this.setUndoRedoUpdateStrategy(new org.anotherearth.NullUpdateStrategy());this.setNewEarthPropsUpdateStrategy(new org.anotherearth.NullUpdateStrategy())};org.anotherearth.LinkCreatorButton.prototype={addChild:function(){},removeChild:function(){}};org.anotherearth.TwoEarthsCheckbox=function(c,h,g){var b,e,f,a,d;var c=c;var h=h;var g=g;this.addClickEventListener=function(i){f=i;$(e).bind("click",function(){i.execute()})};this.createGUIElements=function(){b=document.createElement("div");$(b).addClass("control_panel_element");b.id=h+"_checkbox_container";e=document.createElement("input");e.type="checkbox";e.id=h;var i=document.createElement("label");i.setAttribute("for",h);i.innerHTML=c;b.appendChild(e);b.appendChild(i);b.style.display="none"};this.createIterator=function(){return new org.anotherearth.NullIterator()};this.getIsChecked=function(){return $(e).attr("checked")};this.getContainingElement=function(){return b};this.setIsChecked=function(i){var j=this.getIsChecked();if(i==j){return}(j)?$(e).attr("checked","true"):$(e).attr("checked","false");f.execute()};this.show=function(){b.style.display="block"};this.hide=function(){b.style.display="none"};this.performUndoRedoUpdate=function(){d.execute(this)};this.performNewEarthPropsUpdate=function(){a.execute(this)};this.setUndoRedoUpdateStrategy=function(i){d=i};this.setNewEarthPropsUpdateStrategy=function(i){a=i};this.setTabIndex=function(i){e.setAttribute("tabindex",i++);return i};this.createGUIElements();f=new org.anotherearth.NullCommand();d=new org.anotherearth.NullUpdateStrategy();a=new org.anotherearth.NullUpdateStrategy()};org.anotherearth.TwoEarthsCheckbox.prototype={addChild:function(){},removeChild:function(){}};org.anotherearth.RadioButtons=function(d,c){var d=d;var c=c;var f,b;var a,e;this.addClickEventListener=function(h){f=h;for(var g in d){if(d.hasOwnProperty(g)){if(typeof document.body.style.maxHeight==="undefined"){$(d[g].htmlElement).click(function(){var i=this.getAttribute("name");$("input[name='"+i+"']").removeAttr("checked");$(this).attr("checked","checked");h.execute(this)})}else{$(d[g].htmlElement).click(function(){h.execute(this)})}}}};this.createGUIElements=function(){b=document.createElement("div");$(b).addClass("control_panel_element");b.id=c+"_container";for(var j=0;j<d.length;j++){var h=document.createElement("label");h.setAttribute("for",d[j].id);var g=document.createElement("input");g.type="radio";g.id=d[j].id;g.name=d[j].name;g.value=d[j].value;d[j].htmlElement=g;h.appendChild(g);var k=document.createElement("span");$(k).addClass("radio_button_label_span");k.appendChild(document.createTextNode(d[j].label));h.appendChild(k);b.appendChild(h)}b.style.display="none"};this.createIterator=function(){return new org.anotherearth.NullIterator()};this.getContainingElement=function(){return b};this.getIsChecked=function(g){return $(d[g].htmlElement).attr("checked")};this.getIndexOf=function(j){var h=0;for(var g in d){if(d.hasOwnProperty(g)&&d[g].value===j){break}}return h};this.performUndoRedoUpdate=function(){e.execute(this)};this.performNewEarthPropsUpdate=function(){a.execute(this)};this.setIsChecked=function(h,g){var i=this.getIsChecked(g);if(h===i){return}(i)?$(d[g].htmlElement).attr("checked","true"):$(d[g].htmlElement).attr("checked","false");f.execute(d[g])};this.setTabIndex=function(g){for(var h=0;h<d.length;h++){d[h].htmlElement.setAttribute("tabindex",g++)}return g};this.show=function(){b.style.display="block"};this.hide=function(){b.style.display="none"};this.setNewEarthPropsUpdateStrategy=function(g){a=g};this.setUndoRedoUpdateStrategy=function(g){e=g};this.createGUIElements();f=new org.anotherearth.NullCommand();e=new org.anotherearth.NullUpdateStrategy();a=new org.anotherearth.NullUpdateStrategy()};org.anotherearth.RadioButtons.prototype={addChild:function(){},removeChild:function(){}};org.anotherearth.SearchBox=function(f,b,e,d){var h;var f=f;var b=b;var g=d;var c,a;this.createGUIElements=function(){h=document.createElement("div");h.id=e;$(h).addClass(org.anotherearth.SEARCH_BOX_CLASS);var k=document.createElement("h6");k.appendChild(document.createTextNode(g));$(k).addClass("search_box_label");var i=new google.search.LocalSearch();i.setNoHtmlGeneration();var j=new google.search.SearchControl();j.setSearchCompleteCallback(null,function(){$(".gs-title").removeAttr("href").css("text-decoration","none");$(".gs-directions").remove();var n,l;if(i.results.length&&i.results[0].GsearchResultClass===GlocalSearch.RESULT_CLASS){n=parseFloat(i.results[0].lat);l=parseFloat(i.results[0].lng);var m=f.getCameraProperties();b.jumpCameraCoords(f,n,l,20000,m.tilt,m.head)}});j.addSearcher(i);j.draw(h);h.insertBefore(k,h.firstChild);h.style.display="none"};this.createIterator=function(){return new org.anotherearth.NullIterator()};this.getContainingElement=function(){return h};this.show=function(){$(".gsc-branding-user-defined").siblings().andSelf().remove();h.style.display="block"};this.hide=function(){h.style.display="none"};this.performUndoRedoUpdate=function(){c.execute(this)};this.performNewEarthPropsUpdate=function(){a.execute(this)};this.setTabIndex=function(i){return i};this.createGUIElements();c=new org.anotherearth.NullUpdateStrategy();a=new org.anotherearth.NullUpdateStrategy()};org.anotherearth.SearchBox.prototype={addChild:function(){},removeChild:function(){}};org.anotherearth.SelectBox=function(j,d,b,a,f){var j=j;var d=d;var b=b;var a=a;var f=f;var a=a;var e,g,h;var i,c;this.addClickEventListener=function(p){if(!f){for(var n in j){if(j.hasOwnProperty(n)){$(j[n].htmlElement).click(function(){p.execute(h,this)})}}}else{var o=[];var m=new RegExp(a+"\\d+");var k=document.getElementsByTagName("input");for(var l in k){if(typeof k[l].id!=="undefined"&&k[l].id.match(m)){o.push(k[l])}}$(o).click(function(){p.execute(h,this)})}};this.createGUIElements=function(){g=document.createElement("div");$(g).addClass("control_panel_element").addClass("select_box_container");g.id=a+"_select_box_container";h=document.createElement("select");h.id=a;if(f){h.setAttribute("multiple","multiple")}else{var m=document.createElement("option");m.setAttribute("selected","selected");h.appendChild(m)}for(var l=0;l<j.length;l++){var m=document.createElement("option");m.value=j[l].value;m.appendChild(document.createTextNode(j[l].text));j[l].htmlElement=m;h.appendChild(m)}var k=document.createElement("label");k.appendChild(document.createTextNode(b));g.appendChild(k);g.appendChild(h);if(f){$(h).dropdownchecklist()}g.style.display="none"};this.createIterator=function(){return new org.anotherearth.NullIterator()};this.getContainingElement=function(){return g};this.getIsEnabled=function(k){if($(j[k].htmlElement).attr("disabled")==="disabled"){return false}else{return true}};this.getIsSelected=function(k){if($(j[k].htmlElement).attr("selected")==="selected"){return true}else{return false}};this.setIsSelected=function(k,m){var l=this.getIsSelected(k);if(m===l){return}(l)?$(j[k].htmlElement).removeAttr("selected"):$(j[k].htmlElement).attr("selected","selected");e.execute(h,j[k])};this.performUndoRedoUpdate=function(){i.execute(this)};this.performNewEarthPropsUpdate=function(){c.execute(this)};this.getIndexOfOption=function(l){for(var k=0;k<j.length;k++){if(j[k].value===l){break}}return k};this.setTabIndex=function(k){if(!f){for(var l=0;l<j.length;l++){j[l].htmlElement.tabindex=k++}}return k};this.show=function(){g.style.display="block"};this.hide=function(){g.style.display="none";if(f){$(h).dropdownchecklist("hide")}};this.hideDropDownList=function(){if(f){$(h).dropdownchecklist("hide")}};this.setNewEarthPropsUpdateStrategy=function(k){c=k};this.setUndoRedoUpdateStrategy=function(k){i=k};this.createGUIElements();e=new org.anotherearth.NullCommand();i=new org.anotherearth.NullUpdateStrategy();c=new org.anotherearth.NullUpdateStrategy()};org.anotherearth.SelectBox.prototype={addChild:function(){},removeChild:function(){}};org.anotherearth.UndoButtonUpdateStrategy=function(){};org.anotherearth.UndoButtonUpdateStrategy.prototype={execute:function(a){a.setIsEnabled(a.getModel().getNumberRemainingUndos())}};org.anotherearth.RedoButtonUpdateStrategy=function(){};org.anotherearth.RedoButtonUpdateStrategy.prototype={execute:function(a){a.setIsEnabled(a.getModel().getNumberRemainingRedos())}};org.anotherearth.EquateLatLngsButtonStrategy=function(){};org.anotherearth.EquateLatLngsButtonStrategy.prototype={execute:function(a){var b=a.getModel().getCurrentCameraProperties();if(b.leftEarth.lat===b.rightEarth.lat&&b.leftEarth.lng===b.rightEarth.lng){a.setIsEnabled(false)}else{a.setIsEnabled(true)}}};org.anotherearth.EquateAltitudesButtonStrategy=function(){};org.anotherearth.EquateAltitudesButtonStrategy.prototype={execute:function(a){var b=a.getModel().getCurrentCameraProperties();(b.leftEarth.alt===b.rightEarth.alt)?a.setIsEnabled(false):a.setIsEnabled(true)}};org.anotherearth.EquateTiltsButtonStrategy=function(){};org.anotherearth.EquateTiltsButtonStrategy.prototype={execute:function(b){var d=b.getModel().getCurrentCameraProperties();var c=Math.round(d.leftEarth.tilt*10)/10;var a=Math.round(d.rightEarth.tilt*10)/10;(c===a)?b.setIsEnabled(false):b.setIsEnabled(true)}};org.anotherearth.EquateHeadingsButtonStrategy=function(){};org.anotherearth.EquateHeadingsButtonStrategy.prototype={execute:function(a){var b=a.getModel().getCurrentCameraProperties();(b.leftEarth.head===b.rightEarth.head)?a.setIsEnabled(false):a.setIsEnabled(true)}};org.anotherearth.LinkCreatingButtonUpdateStrategy=function(){};org.anotherearth.LinkCreatingButtonUpdateStrategy.prototype={execute:function(a){a.setIsEnabled(true);a.setIsLinkVisible(false)}};org.anotherearth.NullUpdateStrategy=function(){};org.anotherearth.NullUpdateStrategy.prototype={execute:function(a){}};org.anotherearth.EarthsManager=function(){var i={};i.lat=null;i.lng=null;i.alt=null;i.tilt=null;i.head=null;var c={};c.lat=null;c.lng=null;c.alt=null;c.tilt=null;c.head=null;var d=false;var h=false;var j=false;var g=false;var e=[];var b=[];var a=null;var f={};f.undoRedo=[];f.newEarthProps=[];this.redo=function(){if(this.getNumberRemainingRedos()){a++;e.push(b[b.length-1+a]);this.notifyUndoRedoObservers()}else{throw new Error("nothing to redo - shouldn't be calling method.")}};this.undo=function(){if(a!==null){if(this.getNumberRemainingUndos()){a--}else{throw new Error("nothing to undo - shouldn't be calling method.")}}else{b=e.slice(0);a=-1}e.push(b[b.length-1+a]);this.notifyUndoRedoObservers()};this.getNumberRemainingRedos=function(){return((a===null)?0:-a)};this.getNumberRemainingUndos=function(){return((a===null)?e.length-1:b.length-1+a)};this.getCurrentCameraProperties=function(){return e[e.length-1]};this.saveCameraProperties=function(n,m,k){var l={};l.leftEarth=n;l.rightEarth=m;b=[];a=null;if(k){e.pop()}e.push(l);this.notifyNewEarthPropsObservers()};this.getLtoRCameraPropertyDifferences=function(){return i};this.getRtoLCameraPropertyDifferences=function(){return c};this.getIsHorizMovementLocked=function(){return d};this.getIsVertMovementLocked=function(){return h};this.getIsTiltLocked=function(){return j};this.getIsHeadingLocked=function(){return g};this.setIsHorizMovementLocked=function(k){d=k};this.setIsVertMovementLocked=function(k){h=k};this.setIsTiltLocked=function(k){j=k};this.setIsHeadingLocked=function(k){g=k};this.setCameraCoordDiff=function(k,l){if(l===null){i[k]=null;c[k]=null}else{i[k]=l;c[k]=-l}};this.registerUndoRedoObserver=function(k){f.undoRedo.push(k)};this.registerNewEarthObserver=function(k){f.newEarthProps.push(k)};this.notifyUndoRedoObservers=function(){for(var l in f.undoRedo){if(f.undoRedo.hasOwnProperty(l)){var k=f.undoRedo[l];k.performUndoRedoUpdate()}}};this.notifyNewEarthPropsObservers=function(){for(var l in f.newEarthProps){if(f.newEarthProps.hasOwnProperty(l)){var k=f.newEarthProps[l];k.performNewEarthPropsUpdate()}}}};org.anotherearth.LockableEarth=function(k,r,q){var f;var p=3.5;var u;var n,d,e,i,j;var x={};var t=false;var s=false;var l=this;var k=k;var g;var v;var w=w;var o;var h=function(y){var y;this.set=function(z){y=z};this.enact=function(z){if(z){v=z;u.getFeatures().appendChild(z);if(z.getAbstractView()!==null){u.getView().setAbstractView(z.getAbstractView())}}y()};this.set(y)};var c=function(y){google.earth.fetchKml(u,w,y.enact)};var m=function(y){u=y;n=y.getView();d=y.getWindow();e=y.getOptions();i=y.getLayerRoot();j=y.getTime();u.getNavigationControl().setVisibility(u.VISIBILITY_AUTO);f=u.ALTITUDE_ABSOLUTE;e.setScaleLegendVisibility(true);e.setStatusBarVisibility(true);i.enableLayerById(u.LAYER_ROADS,true);i.enableLayerById(u.LAYER_BORDERS,true);i.enableLayerById(u.LAYER_BUILDINGS,true);i.enableLayerById(u.LAYER_BUILDINGS_LOW_RESOLUTION,true);x.borders=i.getLayerById(u.LAYER_BORDERS);x.roads=i.getLayerById(u.LAYER_ROADS);x.terrain=i.getLayerById(u.LAYER_TERRAIN);x.hiResBuildings=i.getLayerById(u.LAYER_BUILDINGS);x.loResBuildings=i.getLayerById(u.LAYER_BUILDINGS_LOW_RESOLUTION);for(var z in x){if(x.hasOwnProperty(z)){x[z].setVisibility(false)}}l.setCameraProperties(q.lat,q.lng,q.alt,q.tilt,q.head,false);r.saveCameraProperties(false);d.setVisibility(true);google.earth.addEventListener(d,"mouseup",function(){r.respondToMouseUpOnEarth()});google.earth.addEventListener(n,"viewchange",function(){var A=r.getMoveInitializingEarth();if(t){t=false;return}if(A===null){r.setMoveInitializingEarth(l)}else{if(A!==l){return}}r.moveOtherEarthIfLocked(l)});google.earth.addEventListener(n,"viewchangeend",function(){var B=r.getMoveInitializingEarth();if(s){s=false;return}if(B!==l){return}var A=!r.getIsTimeElapsedSufficientForSave();r.saveCameraProperties(A)});r.respondToEarthFullyLoading()};var a=function(y){};var b=function(){g=document.createElement("div");g.id=k;$(g).addClass(org.anotherearth.EARTH_CANVAS_CLASS);$("body").append(g)};this.setCameraProperties=function(E,A,D,y,B,F){if(typeof n==="undefined"){var z=k+" not initialized";throw new ReferenceError(z)}var C=n.copyAsCamera(f);if(F){t=true;s=true}C.setLatitude(E);C.setLongitude(A);C.setAltitude(D);C.setTilt(y);C.setHeading(B);e.setFlyToSpeed(u.SPEED_TELEPORT);n.setAbstractView(C);e.setFlyToSpeed(p)};this.getCameraProperties=function(){if(typeof n==="undefined"){var y=k+" not initialized";throw new ReferenceError(y)}else{var A=n.copyAsCamera(f);var z={};var B=Math.pow(10,6);z.lat=Math.round(A.getLatitude()*B)/B;z.lng=Math.round(A.getLongitude()*B)/B;z.alt=Math.round(A.getAltitude()*B)/B;z.tilt=Math.round(A.getTilt()*B)/B;z.head=Math.round(A.getHeading()*B)/B;return z}};this.toggleExtra=function(C){switch(C){case"atmosphere":e.setAtmosphereVisibility(!e.getAtmosphereVisibility());break;case"hiRes":x.hiResBuildings.setVisibility(!x.hiResBuildings.getVisibility());break;case"loRes":x.loResBuildings.setVisibility(!x.loResBuildings.getVisibility());break;case"borders":x.borders.setVisibility(!x.borders.getVisibility());break;case"grid":e.setGridVisibility(!e.getGridVisibility());break;case"roads":x.roads.setVisibility(!x.roads.getVisibility());break;case"sun":var B=u.getSun();B.setVisibility(!B.getVisibility());break;case"terrain":x.terrain.setVisibility(!x.terrain.getVisibility());break;case"time":var y=j.getControl();if(j.getHistoricalImageryEnabled()){y.getVisibility()?y.setVisibility(u.VISIBILITY_HIDE):y.setVisibility(u.VISIBILITY_SHOW)}else{if(y.getVisibility()){y.setVisibility(false)}else{j.setHistoricalImageryEnabled(true)}}break;default:var A="Unrecognised Overlay Type: "+C;var z=new Error();z.message=A;throw z}};this.createEarthInstance=function(){google.earth.createInstance(k,m,a)};this.setCanvasPositionAndSize=function(B,A,z,y){$(g).css("top",B).css("left",A).css("width",z).css("height",y)};this.addKmlFromUrl=function(z,y){kmlLoadedCallback=new h(y);if(v){if(u){u.getFeatures().removeChild(v)}v=null}w=z;if(typeof u!=="undefined"){c(kmlLoadedCallback)}};this.show=function(){g.style.display="block"};b()};org.anotherearth.EarthsController=function(j,a){var m;var b,h,d;var j=j;var l,c;var o=null;var g=null;var p=2000;var n=null;var q=null;var i=function(){if(!j.getIsHorizMovementLocked()){j.setCameraCoordDiff("lat",null);j.setCameraCoordDiff("lng",null)}else{var r=b.getCameraProperties();var s=h.getCameraProperties();j.setCameraCoordDiff("lat",(r.lat-s.lat));j.setCameraCoordDiff("lng",(r.lng-s.lng))}};var f=function(){if(!j.getIsVertMovementLocked()){j.setCameraCoordDiff("alt",null)}else{j.setCameraCoordDiff("alt",(b.getCameraProperties().alt-h.getCameraProperties().alt))}};var k=function(){if(!j.getIsTiltLocked()){j.setCameraCoordDiff("tilt",null)}else{j.setCameraCoordDiff("tilt",(b.getCameraProperties().tilt-h.getCameraProperties().tilt))}};var e=function(){if(!j.getIsHeadingLocked()){j.setCameraCoordDiff("head",null)}else{j.setCameraCoordDiff("head",(b.getCameraProperties().head-h.getCameraProperties().head))}};this.setEarthLoadingResponseCallback=function(r){q=r};this.getMoveInitializingEarth=function(){return n};this.setMoveInitializingEarth=function(r){n=r};this.getIsTimeElapsedSufficientForSave=function(){var s=new Date().getTime();var r=true;if(o!==null){g=o;o=s;r=(o-g>p)}else{g=o;o=s}return r};this.respondToMouseUpOnEarth=function(){o=null;g=null};this.respondToEarthFullyLoading=function(){q()};this.moveOtherEarthIfLocked=function(r){movingEarth=r;var B=j.getIsTiltLocked();var x=j.getIsHeadingLocked();var u=j.getIsHorizMovementLocked();var y=j.getIsVertMovementLocked();if(u||y||B||x){var D={};var v={};var A={};var s,C;var z=b.getCameraProperties();var E=h.getCameraProperties();if(r===b){A=j.getLtoRCameraPropertyDifferences();D=h;s=E;C=z}else{A=j.getRtoLCameraPropertyDifferences();D=b;s=z;C=E}if(A.alt===null){v.alt=s.alt}else{var t=C.alt-A.alt;v.alt=((t>0)?t:0)}if(A.lng===null){v.lng=s.lng}else{var w=C.lng-A.lng;if(w>=180){v.lng=w-360}else{if(w<=-180){v.lng=w+360}else{v.lng=w}}}v.lat=((A.lat===null)?s.lat:C.lat-A.lat);v.tilt=((A.tilt===null)?s.tilt:C.tilt-A.tilt);v.head=((A.head===null)?s.head:C.head-A.head);D.setCameraProperties(v.lat,v.lng,v.alt,v.tilt,v.head,true)}};this.setLinkCreatorButton=function(r){d=r};this.setLeftEarth=function(r){b=r};this.setRightEarth=function(r){h=r};this.setControlPanel=function(r){m=r};this.setLeftSearchBar=function(r){leftSearchBar=r};this.setRightSearchBar=function(r){rightSearchBar=r};this.jumpCameraCoords=function(w,v,s,u,r,t){w.setCameraProperties(v,s,u,r,t,true);this.saveCameraProperties(false);i();f();e();k()};this.equateCameraAltitudes=function(){if(j.getIsVertMovementLocked()){j.setCameraCoordDiff("alt",0)}var r=l.getCameraProperties();var s=c.getCameraProperties();c.setCameraProperties(s.lat,s.lng,r.alt,s.tilt,s.head,true)};this.equateCameraLatsLngs=function(){if(j.getIsHorizMovementLocked()){j.setCameraCoordDiff("lat",0);j.setCameraCoordDiff("lng",0)}var r=l.getCameraProperties();var s=c.getCameraProperties();c.setCameraProperties(r.lat,r.lng,s.alt,s.tilt,s.head,true)};this.equateCameraTilts=function(){if(j.getIsTiltLocked()){j.setCameraCoordDiff("tilt",0)}var r=l.getCameraProperties();var s=c.getCameraProperties();c.setCameraProperties(s.lat,s.lng,s.alt,r.tilt,s.head,true)};this.equateCameraHeadings=function(){if(j.getIsHeadingLocked()){j.setCameraCoordDiff("head",0)}var r=l.getCameraProperties();var s=c.getCameraProperties();c.setCameraProperties(s.lat,s.lng,s.alt,s.tilt,r.head,true)};this.toggleEarthExtra=function(r,s){(r==="LEarth")?b.toggleExtra(s):h.toggleExtra(s)};this.toggleMovementLock=function(r){d.setIsLinkVisible(false);d.setIsEnabled(true);if(r==="vertical"){j.setIsVertMovementLocked(!j.getIsVertMovementLocked());f()}else{if(r==="horizontal"){j.setIsHorizMovementLocked(!j.getIsHorizMovementLocked());i()}else{if(r==="head"){j.setIsHeadingLocked(!j.getIsHeadingLocked());e()}else{if(r==="tilt"){j.setIsTiltLocked(!j.getIsTiltLocked());k()}}}}};this.toggleDonorEarth=function(r){if(r==="left_earth"){l=b;c=h}else{if(r==="right_earth"){l=h;c=b}else{throw new Error("unrecognised donor value: ")}}};this.saveCameraProperties=function(r){var u,t;try{u=b.getCameraProperties();t=h.getCameraProperties()}catch(s){if(s instanceof ReferenceError){return}else{throw s}}n=null;j.saveCameraProperties(u,t,r)};this.undo=function(){j.undo()};this.redo=function(){j.redo()};this.createLink=function(){var r=org.anotherearth.URLManager.createURLFromCurrentParameters(b,h,j);d.addLink(r);d.setIsLinkVisible(true);d.setIsEnabled(false)};this.performUndoRedoUpdate=function(){var r=j.getCurrentCameraProperties();if(typeof r==="undefined"||r===null){return}b.setCameraProperties(r.leftEarth.lat,r.leftEarth.lng,r.leftEarth.alt,r.leftEarth.tilt,r.leftEarth.head,true);h.setCameraProperties(r.rightEarth.lat,r.rightEarth.lng,r.rightEarth.alt,r.rightEarth.tilt,r.rightEarth.head,true);i();f();e();k()}};org.anotherearth.URLManager={};org.anotherearth.URLManager.createURLFromCurrentParameters=function(i,g,d){var c=i.getCameraProperties();var e=g.getCameraProperties();var h={};h.LLat=c.lat;h.LLng=c.lng;h.LAlt=c.alt;h.LTilt=c.tilt;h.LHead=c.head;h.RLat=e.lat;h.RLng=e.lng;h.RAlt=e.alt;h.RTilt=e.tilt;h.RHead=e.head;h.isTiltLocked=(d.getIsTiltLocked())?1:0;h.isHeadingLocked=(d.getIsHeadingLocked())?1:0;h.isAltLocked=(d.getIsVertMovementLocked())?1:0;h.isLatLngLocked=(d.getIsHorizMovementLocked())?1:0;var b=location.protocol+"//"+location.host+location.pathname;var a=function(){a=function(){return"&"};return"?"};for(var f in h){if(h.hasOwnProperty(f)){b+=a()+f+"="+h[f]}}return b};org.anotherearth.URLManager.getURLQueryStringValue=function(b){var a=new RegExp(b+"=([-,\\d.]*)");var c=location.search.match(a);if(c!==null){return c[1]}else{return null}};org.anotherearth.Translator={};org.anotherearth.Translator.translatePage=function(){var b=google.maps.Language.getLanguageCode();if(b!=="en"&&google.language.isTranslatable(b)){var c=function(d,e){google.language.translate(d,"en",b,function(f){if(!f.error){f.translation=f.translation.replace(/&#\d{2};/,"");e(f.translation)}})};var a=new Translator(c);a.sync=false;a.traverse($("body")[0])}};org.anotherearth.ToggleMovementLockCommand=function(b,a){var b=b;var a=a;this.execute=function(){a.toggleMovementLock(b)}};org.anotherearth.ToggleEarthExtraCommand=function(a){var a;this.execute=function(d,c){var b=((d.id===org.anotherearth.CP_R_EARTH_EXTRAS_SELECTOR_ID)?"REarth":"LEarth");a.toggleEarthExtra(b,c.value)}};org.anotherearth.LinkCreatorCommand=function(a){var a=a;this.execute=function(){a.createLink()}};org.anotherearth.UndoCommand=function(a){var a=a;var b=true;this.execute=function(){if(!b){return}b=false;a.undo();b=true}};org.anotherearth.RedoCommand=function(a){var a=a;var b=true;this.execute=function(){if(!b){return}b=false;a.redo();b=true}};org.anotherearth.EquateCameraAltitudesCommand=function(a){var a=a;this.execute=function(){a.equateCameraAltitudes();a.saveCameraProperties(false)}};org.anotherearth.EquateCameraLatsLngsCommand=function(a){var a=a;this.execute=function(){a.equateCameraLatsLngs();a.saveCameraProperties(false)}};org.anotherearth.EquateCameraTiltsCommand=function(a){var a=a;this.execute=function(){a.equateCameraTilts();a.saveCameraProperties(false)}};org.anotherearth.EquateCameraHeadingsCommand=function(a){var a=a;this.execute=function(){a.equateCameraHeadings();a.saveCameraProperties(false)}};org.anotherearth.ToggleDonorEarthCommand=function(a){var a=a;this.execute=function(b){a.toggleDonorEarth(b.value)}};org.anotherearth.NullCommand=function(){this.execute=function(){}};$(document).ready(function(){org.anotherearth.init()});org.anotherearth.init=function(){delete org.anotherearth.init;$("#"+org.anotherearth.JS_INCOMPATIBILITY_MESSAGE_ID).remove();if(!google.earth.isSupported()){var c=document.createElement("div");$(c).addClass("ui-state-highlight").addClass("panel").addClass("ui-widget");var e=document.createElement("p");e.appendChild(document.createTextNode("Sorry; the combination of browser and operating system you are using is incompatible with the Google Earth plugin upon which this application relies."));c.id=org.anotherearth.PLUGIN_INCOMPATIBILITY_MESSAGE_ID;c.appendChild(e);$("body").append(c);org.anotherearth.Translator.translatePage()}else{$("#"+org.anotherearth.PLAIN_HTML_MESSAGE_ID).remove();var b=org.anotherearth.Container.getInstance();if(navigator.userAgent.indexOf("Firefox/2")>0){$("#"+org.anotherearth.CP_ID).css("width","18em");$(".ui-dropdownchecklist").addClass("FF2_checklist")}$("#"+org.anotherearth.CP_ID).css("position","absolute");if(!$.support.leadingWhitespace){$(".panel").css("padding-bottom","1em").css("left","240px");$("#"+org.anotherearth.CP_ID).css("width","18em").css("left","240px");$(".drag_handle").remove()}if(typeof document.body.style.maxHeight==="undefined"){$(".ui-dropdownchecklist-dropcontainer").css("width","10em");$(".ui-dropdownchecklist-text").css("width","10em");$(".ui-dropdownchecklist-item").css("width","10em");$("span.ui-dropdownchecklist-text").text("");$(".ui-dropdownchecklist-dropcontainer input:first-child").attr("checked",false)}var f=b.getComponent("leftEarth");var a=b.getComponent("rightEarth");var d=function(){var g=$(window).width();var h=window.innerHeight?window.innerHeight:$(window).height();f.setCanvasPositionAndSize(0,0,g/2-30,h-40);a.setCanvasPositionAndSize(0,g/2-10,g/2-30,h-40)};$(window).resize(d);d();b.getComponent("welcomePanel").show();f.createEarthInstance();a.createEarthInstance();org.anotherearth.Translator.translatePage()}};